# This is a Databricks asset bundle definition for misc.
# See https://docs.databricks.com/dev-tools/bundles/index.html for documentation.
bundle:
  name: dcf_valuation
  uuid: 5cace7cd-91f4-4f5b-9ded-4985fda4562d

artifacts:
  uv_build:
    type: whl
    build: "uv build"
    path: .

include:
  - resources/*.yaml

variables:
  environments:
    description: Serverless environments for use.
    type: complex
    default:
      - environment_key: default
        spec:
          client: '4'
          dependencies:
            - ./dist/*.whl
            - /Workspace/Deployments/superwind/prd/artifacts/.internal/superwind-0.2.1-py3-none-any.whl
  from_package:
    default: dcf_valuation.assets

targets:
  dev:
    mode: development
    default: true
    workspace:
      host: https://dbc-51f1a5f2-687a.cloud.databricks.com
    # DEV uses dcf_valuation_dev (gold-only), disable full PRD job
    resources:
      jobs:
        dcf_valuation: null

  prd:
    mode: production
    workspace:
      host: https://dbc-51f1a5f2-687a.cloud.databricks.com
      root_path: /Workspace/Deployments/${bundle.name}/${bundle.target}
    permissions:
      - user_name: lee.nathan.sh@outlook.com
        level: CAN_MANAGE
    run_as:
      user_name: lee.nathan.sh@outlook.com
    # PRD uses dcf_valuation (full job), disable dev-only job
    resources:
      jobs:
        dcf_valuation_dev: null
